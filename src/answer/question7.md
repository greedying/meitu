##设计图

  web端=>DNS服务器分流=>nginx服务器=> 日志服务器=> mysql服务器
                                         　↓ 
                                      缓存服务器


## 数据库存储方式

+ `引擎：` 因为读多该少，正好是myIsam的使用场景，所以使用myIsam引擎
+ `表和库`: 可以根据用户ip进行分表分库操作
+ `缓存`: 因为对数据实时性要求不高，所以可以使用缓存服务器，批量插入数据

## 机器量

### nginx服务器
  假设每天的请求次数为10亿次，则每秒的请求数为11574。
  因为nginx只是简单转发，并发数完全能达到这个数量，
  
  所以nginx服务器一台

### 日志服务器
  我们假设是php服务器，内存为4G
  按照每个请求100ms计算，每个php进程占用30M内存。
  则一秒内处理请求数为 4000/30 * 10 = 1333。
  11574 / 1333 = 8.6 

  所以php服务器按照10台计算

## 缓存服务器
  以memcache为例，考虑到memcache的高并发数以及防止单点故障，两台memcache即可。

## 数据库

  以mysql为例子。通过合理的分表分库，以及通过读取缓存批量插入数据，实际上数据库的压力并不像看起来那么大，因为没有具体数据不好估计，按照php服务器台数10台计算。当然这不包括历史数据


## 综上，我们需要1+10+2+10 = 23台服务器。这里没有考虑用户的点击时间分配不均问题。


## QPS:
  根据上面推理，按照11574/s计算，所以能承受的点击也是大约等于这个频率


## 难点

+ 用户点击在不同时间的分布不均匀
+ 历史数据处理问题

